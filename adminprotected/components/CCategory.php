<?php/* * 分类(元素间有父子关系的)的基础函数类 */class CCategory{	const SHOW_SELECT='—请选择—';	const SHOW_TOPCATGORY='——顶级分类——';	const SHOW_ALLCATGORY='——查看全部分类——';	/*	 * 分类目录递归列表	 * 返回父类的所有子类	 */	static public function getAllChildren($all, $parent_id=0){		return self::allChildren($all,$parent_id);	}	/*	 * 所有子类的id组成的数组	 */	static public function getAllChildrenIds($all,$parent_id=0){		return self::allChildren($all,$parent_id, 'id');	}	/**	 * 分类目录递归列表	 * 返回父类的所有子类	 */	private static function allChildren($all,$parent_id=0,$type = 'all',&$children = array()){		foreach($all as $v){			if($v['parent_id']==$parent_id){				$children[] = $type == 'all' ? $v : $v['id'];				self::allChildren($all,$v['id'],$type,$children);			}		}		return $children;	}	/**	 * 分类目录下拉列表	 */	 	static public function showAllDroplist($all,$parent_id=0, $level=0)	{		self::showAllChildren($all,$parent_id=0, $level=0);		$children=array(0=>self::SHOW_SELECT);		$categoryList = self::showAllChildren($all);		foreach($categoryList as $v){			$children[$v['id']]=$v['selectName'];		}		return $children;	}	/**	 * 级联显示	 * 分类目录递归列表	 * 返回父类的所有子类	 * &$categoryList 引用传值返回	 */	public static function showAllChildren($all,$parent_id=0, $level=0,$separate = ''){		static $children = array();		foreach($all as $v){			if($v['parent_id']==$parent_id)			{				$v['level'] = $level;				$v['selectName'] = $separate.$v['name'];				$children[] = $v;				self::showAllChildren($all,$v['id'], $level + 1, $separate . '—');			}		}		return $children;	} }